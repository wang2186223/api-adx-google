# APIæ•°æ®è‡ªåŠ¨åŒæ­¥ç³»ç»Ÿ

è¿™ä¸ªç³»ç»Ÿä¼šæ¯å°æ—¶è‡ªåŠ¨ä»APIæ‹‰å–æ•°æ®å¹¶æŒ‰æ—¥æœŸå­˜å‚¨ï¼Œæ”¯æŒå¢é‡æ›´æ–°ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- â° æ¯å°æ—¶è‡ªåŠ¨è¿è¡Œï¼ˆåŒ—äº¬æ—¶é—´ï¼‰
- ğŸ“… åªæ›´æ–°å½“æ—¥å’Œå‰ä¸€æ—¥çš„æ•°æ®
- ğŸ—‚ï¸ æŒ‰æ—¥æœŸåˆ†æ–‡ä»¶å­˜å‚¨ï¼ˆJSONæ ¼å¼ï¼‰
- ğŸ“Š è¯¦ç»†çš„æ—¥å¿—è®°å½•
- ğŸ”§ çµæ´»çš„é…ç½®ç®¡ç†

## æ–‡ä»¶ç»“æ„

```
apiæ¥å£/
â”œâ”€â”€ config.json          # é…ç½®æ–‡ä»¶ï¼ˆAPIå‡­è¯ã€å­˜å‚¨è·¯å¾„ç­‰ï¼‰
â”œâ”€â”€ data_sync.py         # ä¸»è¦çš„æ•°æ®åŒæ­¥è„šæœ¬
â”œâ”€â”€ test_sync.py         # æµ‹è¯•è„šæœ¬
â”œâ”€â”€ install_dependencies.sh  # å®‰è£…ä¾èµ–è„šæœ¬
â”œâ”€â”€ setup_cron.sh        # é…ç½®å®šæ—¶ä»»åŠ¡è„šæœ¬
â”œâ”€â”€ data/                # æ•°æ®å­˜å‚¨ç›®å½•
â”‚   â”œâ”€â”€ data_2025-10-13.json
â”‚   â””â”€â”€ data_2025-10-12.json
â””â”€â”€ logs/                # æ—¥å¿—å­˜å‚¨ç›®å½•
    â”œâ”€â”€ data_sync_20251013.log
    â””â”€â”€ cron.log
```

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
chmod +x install_dependencies.sh
./install_dependencies.sh
```

### 2. é…ç½®APIå‡­è¯

ç¼–è¾‘ `config.json` æ–‡ä»¶ï¼Œç¡®è®¤APIå‡­è¯æ­£ç¡®ï¼š

```json
{
    "api": {
        "base_url": "https://api.adoptima.net/get_app_data/get_adx",
        "username": "your_username",
        "password": "your_password"
    }
}
```

### 3. æµ‹è¯•è¿è¡Œ

```bash
python3 test_sync.py
```

### 4. é…ç½®å®šæ—¶ä»»åŠ¡

```bash
chmod +x setup_cron.sh
./setup_cron.sh
```

## æ•°æ®æ›´æ–°é€»è¾‘

- **å½“æ—¥æ•°æ®**: æ¯å°æ—¶è¦†ç›–æ›´æ–°
- **å‰ä¸€æ—¥æ•°æ®**: æ¯å°æ—¶è¦†ç›–æ›´æ–°  
- **å†å²æ•°æ®**: ä¿æŒä¸å˜ï¼ˆå¿«ç…§å½¢å¼ï¼‰

ä¾‹å¦‚ï¼šä»Šå¤©æ˜¯2025å¹´10æœˆ13æ—¥
- âœ… æ›´æ–°ï¼š2025-10-13.json
- âœ… æ›´æ–°ï¼š2025-10-12.json  
- âŒ ä¸æ›´æ–°ï¼š2025-10-11.jsonåŠæ›´æ—©çš„æ–‡ä»¶

## ç›‘æ§å’Œç»´æŠ¤

### æŸ¥çœ‹å®šæ—¶ä»»åŠ¡çŠ¶æ€
```bash
crontab -l
```

### æŸ¥çœ‹å®æ—¶æ—¥å¿—
```bash
tail -f /Users/k/Desktop/apiæ¥å£/logs/data_sync_$(date +%Y%m%d).log
```

### æŸ¥çœ‹cronæ‰§è¡Œæ—¥å¿—
```bash
tail -f /Users/k/Desktop/apiæ¥å£/logs/cron.log
```

### æ‰‹åŠ¨æ‰§è¡ŒåŒæ­¥
```bash
cd /Users/k/Desktop/apiæ¥å£
python3 data_sync.py
```

## é…ç½®è¯´æ˜

### config.json
- `api.base_url`: APIæ¥å£åœ°å€
- `api.username`: APIç”¨æˆ·å
- `api.password`: APIå¯†ç 
- `storage.data_directory`: æ•°æ®æ–‡ä»¶å­˜å‚¨ç›®å½•
- `storage.log_directory`: æ—¥å¿—æ–‡ä»¶å­˜å‚¨ç›®å½•
- `timezone`: æ—¶åŒºè®¾ç½®ï¼ˆé»˜è®¤ï¼šAsia/Shanghaiï¼‰

## æ•…éšœæ’æŸ¥

### 1. æƒé™é—®é¢˜
```bash
chmod +x data_sync.py
chmod +x test_sync.py
```

### 2. Pythonè·¯å¾„é—®é¢˜
ç¡®ä¿ä½¿ç”¨Python3ï¼š
```bash
which python3
/usr/bin/python3 --version
```

### 3. ç½‘ç»œè¿æ¥é—®é¢˜
æ£€æŸ¥APIæ˜¯å¦å¯è®¿é—®ï¼š
```bash
curl "https://api.adoptima.net/get_app_data/get_adx?username=my&password=Netlink@123&from_date=2025-10-13&to_date=2025-10-13"
```

### 4. æŸ¥çœ‹è¯¦ç»†é”™è¯¯
```bash
python3 data_sync.py
```

## æ³¨æ„äº‹é¡¹

1. **æ—¶åŒº**: ç³»ç»Ÿä½¿ç”¨åŒ—äº¬æ—¶é—´ï¼ˆAsia/Shanghaiï¼‰
2. **ç½‘ç»œ**: ç¡®ä¿æœåŠ¡å™¨èƒ½è®¿é—®APIæ¥å£
3. **å­˜å‚¨**: ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´
4. **æƒé™**: ç¡®ä¿è„šæœ¬æœ‰è¯»å†™dataå’Œlogsç›®å½•çš„æƒé™
5. **æ—¥å¿—æ¸…ç†**: ç³»ç»Ÿä¼šè‡ªåŠ¨æ¸…ç†30å¤©å‰çš„æ—¥å¿—æ–‡ä»¶

## æŠ€æœ¯ç»†èŠ‚

- **è¯­è¨€**: Python 3.x
- **ä¾èµ–**: requests, pytz
- **å®šæ—¶**: crontab (æ¯å°æ—¶ç¬¬5åˆ†é’Ÿæ‰§è¡Œ)
- **æ—¥å¿—**: æŒ‰å¤©åˆ†å‰²ï¼Œè‡ªåŠ¨æ¸…ç†
- **æ•°æ®æ ¼å¼**: JSON
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸æ•è·å’Œæ—¥å¿—è®°å½•